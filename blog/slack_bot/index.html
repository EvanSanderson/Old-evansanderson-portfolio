<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title> Evan J Sanderson-Movius | Slack Bot</title>
  <link rel="stylesheet" href="../../dist/css/style.min.css">
  <link href="https://fonts.googleapis.com/css?family=Arvo" rel="stylesheet">
  <link rel="icon" href="../../favicon.ico" type="image/x-icon">
</head>
<body class="blue">
    <header class="flex-container header header__blog">
        <a href="https://github.com/EvanSanderson" class="contact-icons">
          <svg aria-labelledby="simpleicons-github-icon" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <title id="simpleicons-github-icon">GitHub icon</title>
          <path fill="#fff" d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
        </svg>
      </a>
            <a href="https://www.linkedin.com/in/evanjaysanderson/" class="contact-icons">
              <svg aria-labelledby="simpleicons-linkedin-icon" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <title id="simpleicons-linkedin-icon">LinkedIn icon</title>
              <path fill="#fff" d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"
              />
            </svg>
          </a>
        <a href="mailto:evan.j.sanderson@gmail.com" class="contact-icons">
          <svg aria-labelledby="simpleicons-gmail-icon" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <title id="simpleicons-gmail-icon">Gmail icon</title>
            <path fill="#fff" d="M24 4.5v15c0 .85-.65 1.5-1.5 1.5H21V7.387l-9 6.463-9-6.463V21H1.5C.649 21 0 20.35 0 19.5v-15c0-.425.162-.8.431-1.068C.7 3.16 1.076 3 1.5 3H2l10 7.25L22 3h.5c.425 0 .8.162 1.069.432.27.268.431.643.431 1.068z"
            />
          </svg>
        </a>
        <a aria-label="Blog" href="../../blog" class="contact-icons">
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
            <g>
             <g>
               <g>
                   <path fill="#fff" d="M93.238,220.968h172.463c4.466,0,8.084-3.619,8.084-8.084s-3.618-8.084-8.084-8.084H93.238
                       c-4.466,0-8.084,3.619-8.084,8.084S88.772,220.968,93.238,220.968z"/>
                   <path fill="#fff" d="M93.238,177.853h97.01c4.466,0,8.084-3.619,8.084-8.084s-3.618-8.084-8.084-8.084h-97.01
                       c-4.466,0-8.084,3.619-8.084,8.084S88.772,177.853,93.238,177.853z"/>
                   <path fill="#fff" d="M114.796,398.282h280.253c16.344,0,29.642-13.298,29.642-29.642v-91.082c0-5.206-1.371-10.333-3.968-14.822
                       c-2.233-3.865-7.179-5.189-11.044-2.953c-3.866,2.233-5.188,7.179-2.953,11.044c1.176,2.034,1.797,4.362,1.797,6.732v91.082
                       c0,7.43-6.044,13.474-13.474,13.474H114.796c-7.43,0-13.474-6.044-13.474-13.474v-91.082c0-7.43,6.044-13.474,13.474-13.474
                       h150.905c4.466,0,8.084-3.619,8.084-8.084c0-4.466-3.618-8.084-8.084-8.084H114.796c-16.344,0-29.642,13.298-29.642,29.642
                       v91.082C85.154,384.984,98.452,398.282,114.796,398.282z"/>
                   <path fill="#fff" d="M477.068,412.237c1.684-5.067,2.596-10.484,2.596-16.11V158.989c0-28.231-22.969-51.2-51.2-51.2h-45.81V29.642
                       C382.653,13.298,369.355,0,353.01,0h-21.558c-16.344,0-29.642,13.298-29.642,29.642v78.147H83.537
                       c-28.231,0-51.2,22.969-51.2,51.2v237.137c0,5.627,0.912,11.043,2.596,16.11C14.43,419.065,0,438.368,0,460.8
                       C0,489.031,22.969,512,51.2,512h409.6c28.231,0,51.2-22.969,51.2-51.2C512,438.368,497.57,419.065,477.068,412.237z
                        M317.979,29.642c0-7.43,6.044-13.474,13.474-13.474h21.558c7.43,0,13.474,6.044,13.474,13.474v13.474h-48.505V29.642z
                        M366.484,59.284v188.632h-16.168V59.284H366.484z M317.979,59.284h16.168v188.632h-16.168V59.284z M317.979,264.084h48.505
                       v20.66c0,0.579-0.192,1.153-0.539,1.617l-21.558,28.743c-0.704,0.938-1.652,1.078-2.156,1.078c-0.503,0-1.452-0.14-2.156-1.078
                       l-21.557-28.741c-0.348-0.466-0.54-1.04-0.54-1.619V264.084z M48.505,158.989c0-19.317,15.715-35.032,35.032-35.032h218.274
                       v37.726h-57.667c-4.466,0-8.084,3.619-8.084,8.084s3.618,8.084,8.084,8.084h57.667v106.892c0,4.053,1.339,8.071,3.773,11.318
                       l21.558,28.743c3.596,4.796,9.096,7.545,15.091,7.545c5.994,0,11.495-2.75,15.091-7.545l21.559-28.745
                       c2.433-3.244,3.772-7.263,3.772-11.316v-63.776h33.954c4.466,0,8.084-3.619,8.084-8.084s-3.619-8.084-8.084-8.084h-33.954
                       v-26.947h33.954c4.466,0,8.084-3.619,8.084-8.084s-3.619-8.084-8.084-8.084h-33.954v-37.726h45.81
                       c19.317,0,35.032,15.715,35.032,35.032v237.137c0,19.317-15.715,35.032-35.032,35.032H83.537
                       c-19.317,0-35.032-15.715-35.032-35.032V158.989z M460.8,495.832H51.2c-19.317,0-35.032-15.715-35.032-35.032
                       c0-16.257,11.071-30.113,26.426-33.963c9.349,12.434,24.222,20.49,40.943,20.49h344.926c16.72,0,31.594-8.056,40.943-20.49
                       c15.355,3.85,26.426,17.707,26.426,33.963C495.832,480.117,480.117,495.832,460.8,495.832z"/>
                   <path fill="#fff" d="M235.52,463.495h-1.078c-4.466,0-8.084,3.618-8.084,8.084c0,4.466,3.618,8.084,8.084,8.084h1.078
                       c4.466,0,8.084-3.618,8.084-8.084C243.604,467.113,239.986,463.495,235.52,463.495z"/>
                   <path fill="#fff" d="M433.853,463.495H272.168c-4.466,0-8.084,3.618-8.084,8.084c0,4.466,3.618,8.084,8.084,8.084h161.684
                       c4.466,0,8.084-3.618,8.084-8.084C441.937,467.113,438.318,463.495,433.853,463.495z"/>
                   <path fill="#fff" d="M202.105,463.495h-1.078c-4.466,0-8.084,3.618-8.084,8.084c0,4.466,3.618,8.084,8.084,8.084h1.078
                       c4.466,0,8.084-3.618,8.084-8.084C210.189,467.113,206.571,463.495,202.105,463.495z"/>
                   <path fill="#fff" d="M164.379,463.495H78.147c-4.466,0-8.084,3.618-8.084,8.084c0,4.466,3.618,8.084,8.084,8.084h86.232
                       c4.466,0,8.084-3.618,8.084-8.084C172.463,467.113,168.845,463.495,164.379,463.495z"/>
                    </g>
                </g>
            </g>
        </svg>
        </a>
      </header>
      <section class="flex-container blog module-padding">
        <div class="flex-containter column blog-post">
            <h1 class="blog-title">Cut me some Slack</h1>
            <h2 class="blog-subtitle">Creating a Slack-bot to help manage a shared component library</h2>
            <p class="blog-byline">12.20.20 by Me (Evan)</p>
            <p>
                At work, we have a shared component library that lives in a private registry filled with Vue components for a variety of different UI elements.
                This component library, which we call “Legos”, includes things as simple as buttons to more complicated items like API-aware lists of news cards.
                We’ve worked very hard to make these components reusable, well-tested, and accessible, and we’ve tried to make the development and implementation of these components as easy as possible.
            </p>
            <p>
                One final workflow hurdle is that, because the component library is imported as an NPM package, in order to see the changes from recent work done on a shared component, our developers need to make a pull request that “bumps” the version of the library to the latest version. Is this a huge impediment? No, but it is something that can cause a little bit of cognitive dissonance when trying to communicate with QA or project management. Take this example:
            </p>
            <ul>
                <li>Developer A gets a ticket to add an aria-label to an icon on Page A.</li>
                <li>Developer A realizes that the element in question on Page A is actually inside of a “Lego”.</li>
                <li>Developer A implements the change in our shared package, PRs it, and has it merged.</li>
            </ul>
            <p>
                The package goes through our CI system, and a new minor version of the component library is published.
            </p>
            <p>
                It’s at this moment that Developer A might seem to be done with their work, since the PR is merged and the actual development is done. But there is an additional chore that needs to be completed, as described above, which is to import the latest version in the consuming project that contains Page A. And this process is repeated manifold for all the various interfaces across all of our applications - dozens of PRs across multiple applications that are simply to have the necessary changes manifest themselves in the required way.
            </p>
            <p>
                With that in mind, I decided to build a Slack app that would help us manage this process. We already have some Slack integrations to help with builds and deployments, so it’s not a foreign tool for our team. Additionally, I wanted something that would be right at our fingertips, so that anyone (even, potentially, non-developers) could rectify the common situation of work being done in Legos, but not appearing in a relevant project.
            </p>
            <p>
                What I wanted from the app was simple: a user could issue a slash command (/legos) followed by the name of an app. Then the Slack app would take care of the rest, alerting the user if the app was up to date with its version of our component library, and if not doing the updating itself and then pushing that update to a remote working branch.
            </p>
            <div class="blog-image flex-container justify-center">
                <img height="auto" width="50%" alt="A screenshot of JS code related to initializing a Slack app" src="../../../dist/assets/initializing_slack_app.png"/>
            </div>
            <p>
                I went about building the app in Node, and used Slacks voluminous documentation as a starting point. The major challenges were:
            </p>
            <ul>
                <li>Determining if the current version of our component library was the latest available - not as easy as it seems! One could get the latest version of a package, but comparing that effectively to the current used version took a little bit of problem solving.</li>
                <li>Authenticating requests to our Bitbucket server - we would need to both pull down and push to our Bitbucket instance in order to update repos accordingly.</li>
                <li>Passing configuration into a Docker container living in EKS - The node app would be living in a pod in our Elastic Kubernetes Service, and we would need to pass sensitive configuration such as environment variables in order to do the authenticating described above</li>
            </ul>
            <p>
                A final major challenge was getting the workflow established for how to properly test a Slack app during local development! I created a test workspace, registered my app at api.slack.com, and then initialized a slash command. But the command itself needs a publicly accessible web address to proxy calls to, meaning I couldn’t just pass in localhost:3000 and start testing away.
            </p>

            <p>
                A tool called ngrok came to the rescue in this case. Their tag line, I think, says all you need to know: “secure introspectable tunnels to localhost”. Essentially, I run ngrok from the command line with a flag for the local port I want bound to, it provides a tunnel to a web address, and that web address is provided to my slack command. It literally works like magic.
            </p>
            <div class="blog-image flex-container justify-center">
                <img width="auto" height="600px" alt="The Slack API interface" src="../../../dist/assets/slack_api_screenshot.png"/>
            </div>
            <p>
                Currently, my Slack application works as intended locally. I can pass in the name of one of our consuming applications, have it feedback whether the shared library is up to date, and have it successfully “bump” to the latest version if not. While all is well working within a Docker container running on my local machine, the next step is to move the application into Kubernetes running in AWS. I’m sure that will have its own challenges and learning opportunities -- and perhaps a blog post of its own.
            </p>
            <p>
                Thanks for reading!
            </p>
        </div>
      </section>
</body>
</html>
